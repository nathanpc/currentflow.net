<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
<title>Current Flow</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Sanitize -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css" integrity="sha256-gk3z+XTkT2rjrvAxcKDA15OH4w1FssyEwnSC3WnKbWU=" crossorigin="anonymous" />

<!-- Prism (Syntax Highlighting) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js" integrity="sha256-jc6y1s/Y+F+78EgCT/lI2lyU7ys+PFYrRSJ6q8/R8+o=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css" integrity="sha256-N1K43s+8twRa+tzzoF3V8EgssdDiZ6kd9r8Rfgg8kZU=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autolinker/prism-autolinker.min.js" integrity="sha256-SBdcXd1yqPQNixmtcMwSZJrzPTudHK/LXJxgLGCh3Go=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-uCRLqQjYcKEykao3hISbnt7+Pf9EfLCJUD2oD0JLq40=" crossorigin="anonymous"></script>
<script>Prism.plugins.autoloader.languages_path = 'https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/';</script>

<!-- Custom CSS -->
<link rel="stylesheet" href="/currentflow.net//css/main.css">


	</head>

	<body>
		<!--[if IE]>
		<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
		<![endif]-->

		<!-- Header -->
		<header>
			<div class="title-block">
	<h1><a href="/currentflow.net/">Current Flow</a></h1>
	<h3>Endeavours into the world of programming and electronics</h3>
</div>

<!-- Navigation Bar -->
<nav>
	<ul>
		<li><a href="/currentflow.net/">Home</a></li>
		<li><a href="https://nathancampos.me/">About</a></li>
		<li><a href="#">Contact</a></li>
	</ul>
</nav>


		</header>

		<!-- Articles -->
		<div class="article-container">
			<hr>
			<article>
	<h2><a href="/currentflow.net/post/2016-11-02-MintyVCAtt-Altoids-Tin-VCA.html">MintyVCAtt - Altoids Tin VCA</a></h2>
	<nav>Nathan Campos - Wed 2 November 2016</nav>

	<div class="article-body"><meta name="title" content="MintyVCAtt - Altoids Tin VCA">
<meta name="author" content="Nathan Campos">
<meta name="created" content="2016-11-02">

<p>For the last couple of months I&rsquo;ve been pretty hooked into audio projects, specially music creation related. This was the first quick project I&rsquo;ve built to hopefully end up with a semi-modular synthesizer in a very distant future. The main idea is to basically build a bunch of the simple building blocks of a modular synth in the worst way possible, using Altoids tins and project boxes instead of a rack, which will make patching a real nightmare, but I&rsquo;m sure will look even messier than a rack modular synth.</p>

<p class="image-container"><img alt="The final project" src="http://i.imgur.com/9nQCzpC.jpg" /></p>

<p>The project turned up rather well, it was designed to be extremely simple and easy to build, and had to fit inside the tin with the 9V battery and the connectors, this lead to some restrictions in the size of the circuit (compromises).</p>

<p class="image-container"><img alt="Schematic" src="http://i.imgur.com/gd4ayGG.jpg" /></p>

<p>As you can clearly see the circuit is extremely simple, but gets the job done quite well. I&rsquo;ve used the simplest method of voltage controlled attenuation, the LED coupled with a LDR, this gives it very low distortion, but a very slow attack speed compared to <a href="http://sound.whsites.net/articles/vca-techniques.html" target="_blank">other designs</a>. The circuit accepts a 0-3V CV signal which controls the current thought the LED, so more CV means the input signal will be attenuated!</p>

<p>You can also notice something weird in the CV input jack, that&rsquo;s a very handy trick to incorporate a power switch into a project, I learned this method from DIY stompboxes around the internet. The idea is that you connect your power negative to the ring (right channel) of a stereo jack, so that when you connect a mono plug into the socket, the ring and sleeve will be shorted out, connecting your power negative to your circuit&rsquo;s ground.</p>

<p class="image-container"><img alt="Close-up of the circuit" src="http://i.imgur.com/n1wR8IP.jpg" /></p>

<p>The circuit is pretty simple and was made as a quick hack to do some audio experiments, but feel free to play around with it, and feedback is always welcome! </p>

</div>
</article>

<hr>

<article>
	<h2><a href="/currentflow.net/post/2016-10-31-Flower-Pot-Night-Light.html">Flower Pot Night Light</a></h2>
	<nav>Nathan Campos - Mon 31 October 2016</nav>

	<div class="article-body"><meta name="title" content="Flower Pot Night Light">
<meta name="author" content="Nathan Campos">
<meta name="created" content="2016-10-31">

<p>A couple of months back (April if I recall) I was bored and looking for a nice project to kill some time in a rainy saturday. I decided to build a nice night light for my bedroom. I had a set of restrictions put in place so that I would be pleased with the final result, these were:<ul><li>Must run on AAs<li>Adjustable intensity<li>Small and cute<li>Should be built entirely with parts that I had on hand</ul></p>

<p class="image-container"><img alt="In use" src="http://i.imgur.com/EykXSO9.jpg" /></p>

<p>The first challenge was to find a nice enclosure, since this was going to be used as decoration it couldn&rsquo;t just be a bare protoboard with some LEDs or a boring project box. While looking through the pile of stuff (most people would call trash) I had stored in various places around the house, I found a couple of cubic flower pots made in various materials. I thought the ceramic one would fit my bedroom quite well, so that part was done.</p>

<p class="image-container"><img alt="Sanding the case" src="http://i.imgur.com/9E2M1hN.jpg" /></p>

<p>The next thing would be to find a diffuser to cover the LEDs and and give a more uniform light. My first idea was to use acrylic or something like that, but sadly I didn&rsquo;t have any on hand so I had to improvise. Again I went looking through my stuff and found an empty Ferrero Rocher enclosure (I knew I would use it some day), all I had to do was sand and cut it so it would fit the flower pot.</p>

<p class="image-container"><img alt="The finalized board" src="http://i.imgur.com/43fRXNA.jpg" /></p>

<p>The last and most boring part was to solder all the LEDs, they are in a series parallel arrangement, with 9 parallel groups of 2 in series so that I could use a 9V supply. For driving them I decided to build a simple constant current sink with the <a href="https://upload.wikimedia.org/wikipedia/en/thumb/f/fd/Current_Limiter_NPN.PNG/200px-Current_Limiter_NPN.PNG" target="_blank">two NPN transistors in a feedback configuration</a> and designed it in such a way that it would be adjustable up to 100mA.</p>

<p>If you want to see more pictures of the whole process they are all available in this album:<blockquote class="imgur-embed-pub" data-id="a/cMHcO" lang="en"><a href="//imgur.com/cMHcO" target="_blank">Flower Pot Night Light</a></blockquote></p>

</div>
</article>

<hr>

<article>
	<h2><a href="/currentflow.net/post/2016-03-28-Incredible-Chinese-USB-Car-Power-Supply.html">Incredible Chinese USB Car Power Supply</a></h2>
	<nav>Nathan Campos - Mon 28 March 2016</nav>

	<div class="article-body"><meta name="title" content="Incredible Chinese USB Car Power Supply">
<meta name="author" content="Nathan Campos">
<meta name="created" content="2016-03-28">

<p>Recently I bought a couple of those <a href="http://i.imgur.com/zzU5zAu.jpg" target="_blank">super ultra cheap cigarette plug extensions</a> to distribute 12V in the lab for various things. As usual with everything chinese, I decided to open it up to see how horrible it was inside, but I also did that to upgrade the wiring since I would be pulling a couple of amps from this and I want to minimize the voltage drop.</p>

<p class="image-container"><img alt="The thing" src="http://i.imgur.com/WinmYUy.jpg?1" /></p>

<p>This is the incredible thing I found inside the thing as the 5V supply for the USB socket. A 7805 regulator and a 20 ohm 1/4W resistor <strong>in series with the 5V output</strong>. I guess it could have been worse, they could have used a 5.2V zener or the worst of all just a resistor voltage divider.</p>

<p>China never ceases to amaze me. </p>

</div>
</article>

<hr>

<article>
	<h2><a href="/currentflow.net/post/2016-02-19-MintyUSBoost-A-tiny-boost-converter-for-low-power-projects.html">MintyUSBoost: A tiny boost converter for low power projects</a></h2>
	<nav>Nathan Campos - Fri 19 February 2016</nav>

	<div class="article-body"><meta name="title" content="MintyUSBoost: A tiny boost converter for low power projects">
<meta name="author" content="Nathan Campos">
<meta name="created" content="2016-02-19">

<p><a href="http://i.imgur.com/o7x3ixk.jpg" target="_blank"><img alt="The MintyUSBoost in its fitting enclosure" src="http://i.imgur.com/o7x3ixk.jpg?1" /></a></p>

<p>First of all a bit of a back story: This is my first attempt at a DC-DC converter, I&rsquo;ve always thought they were magic black-boxes that you just had to accept and building one yourself without a dedicated chip was something extremely difficult, something that could only be done with some high-speed complex analog circuitry or high-speed microcontrollers. I think a lot of people think the same way and I decided to try out my luck and it worked fine, switchmode converters are not black magic (now only RF is black magic), and I hope I dismistify them for you too in this article.</p>

<p>The idea for this project came because I built a nice portable Class-A headphone amplifier (blog post coming in the future) and I wanted a simple power supply for it when I was using it with my computer, so I had to step the 5V from the USB to the 9V required by the amplifier circuit, the amplifier even though it&rsquo;s Class-A has a low current consumption, so the 2.5W from a normal USB was more than enough. Taking into consideration all this I needed a boost converter with the following specs:<ul><li>5V input at 450mA maximum to work with any USB port<li>9V output able to source up to 110mA (more than enough for my amp)<li>Acceptable voltage ripple and noise since this will be used with pre-amps and the headphone amp</ul></p>

<p class="image-container"><img alt="Schematic of Rev A" src="http://i.imgur.com/erlyHAr.png" /></p>

<p>As you can see there&rsquo;s not a lot happening, and that&rsquo;s the beauty of this design, since it was made for low power projects it doesn&rsquo;t require any of the complexities, it was designed to be minimalistic and easy to build for someone that is new to switchmode converters. The entire feedback control loop is contained inside the PIC12F683 microcontroller, it is a pretty tiny and under-powered micro, but as you will see it works perfectly for this task.</p>

<p>First the power input goes through a 3.3V regulator which provides power to the PIC and also acts as a voltage reference, then the microcontroller takes control of things and starts the PWM, pulsing current through the main inductor L1 while sensing the output voltage, if the voltage is lower than the set voltage it increases the PWM duty cycle, if the voltage is higher than the set voltage it decreases the PWM duty cycle, and that&rsquo;s all you need to create a simple switchmode converter. Here&rsquo;s the code that runs the whole thing (I still need to improve it, so changes are coming):</p>

<p>If you&rsquo;re a bit more experienced with DC-DC converters you&rsquo;ll notice that the components used are a bit overkill, but that&rsquo;s by design because I wanted very low ripple at the output, also in the topic of components, I selected a IRL520 MOSFET and this is very important, since I&rsquo;m driving the gate with very low voltages a logic-level MOSFET is a must, if you want to use a regular MOSFET you&rsquo;ll have to increase the gate voltage using a <a href="http://electronics.stackexchange.com/q/91897" target="_blank">technique shown here</a>.</p>

<p>A very handy tool for everyone designing their own DC-DC converters is <a href="https://learn.adafruit.com/diy-boost-calc/the-calculator" target="_blank">Adafruit&rsquo;s DIY DC-DC Boost Calculator</a>, it was extremely useful to choose the components used in this project and it&rsquo;ll surely help you in yours too. I&rsquo;ve also written a <a href="https://github.com/nathanpc/statistics-playground/blob/master/boost_calc.R" target="_blank">R script</a> to have a offline version of the calculator, it&rsquo;ll be improved in the future, but it&rsquo;s usable right now.</p>

<p>The only issue that I&rsquo;m having with this project so far is the fact that no matter what I try, I can&rsquo;t get the crystal to oscillate, I checked everything, set all the registers correctly and I still can&rsquo;t get it to work, if anyone wants to help it&rsquo;ll be greatly appreciated.</p>

<p class="image-container"><img alt="Noise Figures" src="http://i.imgur.com/Hzm08DQ.png" /></p>

<p>Since all my designs have a lot of local decoupling to keep any noise or ripple from the power source away from sensitive parts I didn&rsquo;t care too much about having extremely low ripple/noise, but if you want to upgrade this you can add a small shunt regulator to really kill any ripple or just add a LC filter to the output.</p>

<p>If you&rsquo;ve got any questions feel free to ask and I&rsquo;m open to suggestions for improvement. </p>

</div>
</article>

<hr>


		</div>

		<!-- Pager -->
		<nav class="pager">
	<p>
		
		<a href='/currentflow.net//page/1.html' class='current'>1</a>
<a href='/currentflow.net//page/2.html'>2</a>
<a href='/currentflow.net//page/3.html'>3</a>
<a href='/currentflow.net//page/4.html'>4</a>
<a href='/currentflow.net//page/5.html'>5</a>
<a href='/currentflow.net//page/6.html'>6</a>
<a href='/currentflow.net//page/7.html'>7</a>
<a href='/currentflow.net//page/8.html'>8</a>
<a href='/currentflow.net//page/9.html'>9</a>
<a href='/currentflow.net//page/10.html'>10</a>

		<a href='/currentflow.net//page/2.html'>&gt;</a>
	</p>
</nav>



		<!-- Page footer -->
		<footer>
			<p>This blog is powered by <a href="https://github.com/nathanpc/levissimo">Levissimo</a>.</p>


		</footer>
	</body>
</html>

